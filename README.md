# Анализ google merch store

#### Анализ факторов влияющих на средний чек

Данный анализ проводился в учебных целях.

#### ЦЕЛИ:
1. Разобраться как работает такой инструмент, как BigQuery; 
2. Научится делать запросы и выгружать данные из BigQuery;
3. Провести обработку данных;
4. Провести первичный анализ данных;
5. Сегментировать аудиторию;
6. Определить ЦА на основе данных и данных из GA (демо аккаунт);
7. Провести когортный анализ;
8. Построить модель данных, которая позвоилт определить факторы влияющие в покупку и средний чек;
9. Построить [дашборд](https://app.powerbi.com/view?r=eyJrIjoiYmU4YmYwOWQtNTc3MS00ZTAzLThkOWItNjVkNjExYmQxZTIyIiwidCI6IjZhNGRlZTAxLWMzZjUtNGQ0Yi1iZGQyLTllMWYxNDgyYWM1ZCIsImMiOjl9&pageName=ReportSection) в Power BI;
10. Определить факторы, влияющие на средний чек и выручку.

##### ИНСТРУМЕНТЫ:
1. Google BigQuery;
2. Google analytics;
3. MS Excel (Построениe многофакторной модели данных);
4. Python (Pandas, NumPy, matplotlib);
5. SQL (запросы в BigQuery);
6. MS Power BI.


#### Ход работы визуализировал с помощью UML схемы. 
Мне кажется она отлично может показывать ход работы, инструменты которые я использовал в проекте, какие шаги предпринимал и какие выводы сделал. (Дашборд в стиле БА/СА)  

<img width="1429" alt="Снимок экрана 2023-07-23 в 12 10 18" src="https://github.com/SmirnovArtemDA/google_mech_store/assets/139784954/c107e11e-34eb-47f7-8a60-db3596773552">


#### ЗАПРОС В BigQuery:

```
SELECT
   fullVisitorId,
   date,
   trafficSource.campaign,
   trafficSource.keyword,
   trafficSource.medium,
   trafficSource.source,
   device.browser,
   device.deviceCategory,
   geoNetwork.continent,
   geoNetwork.country,
   h.page.pagePath,
   h.item.transactionId,
   p.productRevenue,
   p.productQuantity,
   p.productPrice,
   p.v2ProductCategory,
   p.v2ProductName
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*` ,
   UNNEST(hits) as h,
   UNNEST(h.product) as p
WHERE  SAFE_CAST(_TABLE_SUFFIX as INT64) >= 20170101
   and SAFE_CAST(_TABLE_SUFFIX as INT64) < 20170501
```
К сожалению, далеко не все данные демоаккаунта открыты для использования. Например, я захотел посмотреть город пользователя (geoNetwork.city), то мне в выводе данных в каждой строке таблицы увидел запись о том, что данная информация недоступна. 

Для определения, какое действие было выполнено одним и тем же пользователем, буду пользоваться идентификатором fullVisitorId. Это некий обезличенный идентификатор, который, однако, позволит определить, что действия на сайте были совершены одним и тем же человеком (с некоторыми ограничениями, конечно).

Каждая строка таблицы — это отдельный сеанс, поэтому многие столбцы имеют вложенную структуру: например, в рамках одного сеанса пользователь мог посещать несколько страниц или покупать несколько товаров. Поэтому такие поля приходится «раскрывать» — придавать им плоский табличный формат. Я это сделал с помощью функции **UNNEST()**. 

#### Анализ данных 

Весь аназил данных был произведен в Python. С помощью библиотек Pandas, NumPy и Matplotlib

1. Выгруженные данные за четыре месяца. Первым дело открыл в Python и объединил таблицы в одну
2. Данные были в нормальном состоянии, единственное, что необходимо привести в порядок это Дата.
3. Для себя переименовал столбцы (что бы проще было работать)
4. Далее решил провести сегментацию аудитории и посмотреть на распределение данных.
5. Построил когортый анализ. Для этого выделил первые месяцы покупок у пользователей и месяцы покупок. Далее сгрупировал пользователей по месяцам и их когортам. И посчитал процент возврата и среднюю выручку.
6. Выделил уникальные значения в таблице, что бы понять, какие факторы можно выделить для анализа
7. Далее начал строить графики, чтобы визуально понимать, какие факторы все таки влияют на покупку. На графике со средней выруочкой выделил выходные дни.

#### Визуализация данных в Power BI

При построении [дашборда](https://app.powerbi.com/view?r=eyJrIjoiYmU4YmYwOWQtNTc3MS00ZTAzLThkOWItNjVkNjExYmQxZTIyIiwidCI6IjZhNGRlZTAxLWMzZjUtNGQ0Yi1iZGQyLTllMWYxNDgyYWM1ZCIsImMiOjl9&pageName=ReportSection) придерживался идеи, что влиять на покупку может: георгафическое положение, способы поиска и каналы.  

1. Построил дашборд по общим показателям. Для того, что бы можно было посмотреть в разрезе любой переменной. И сделал график с визуализацией выходных дней. Наглядно видно, как в будние дни, начинает повышаться средний чек.
2. Построил дашборд по UTM меткам. Так как они позволяют отслеживать дорогу пользователя, считаю их одним из самых важных разрезов. Дашборд показывает не динамику среднего чека, а именно выручки. Это сделано для того, что бы понимать какой ресурс нам приносит больше всего дохода и как меняется поведение пользователей с появлением той или иной переменной. Из графиков видно, что основная часть пользователи уже знаю магазин и переходят напрямую.  Так же можно наблюдать. Что каналы и способы поиска в основном повторят свою диманику.
3. Изобразил на карте мира средний чек в каждой стране. Визуально видно, что по всему миру он почти одинаковый, но в странах Европы выделяются некоторые страны. 

#### ВЫВОД 
Средний чек не сильно отличается по каким либо факторам. Некоторые показатели имеют хороший средний чек, но это не сильно влияет на общую выручку. В середине марта хорошо себя показа реферальная система, а в апреле резкий рост, а затем спад, показали **dfa. cpm. firefox. **. но такие показатели скорее всего исключение.  Лучше обратить внимание на стабильно показывающий себя, органическикй трафик из google

Выручка в основном приходит от пользователей USA, которые уже знакомы с магазином и переходят напрямую на сайт. ЦА пользователя - это Американец (мужчина), знакомый или работающий в IT индустрией, возрастом 21-35 лет, любит продукты google. 

Примерно 50% пользователей приходится на Америку, а USA генерирует 95% выручки магазина. 
